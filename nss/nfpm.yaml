# yaml-language-server: $schema=https://nfpm.goreleaser.com/static/schema.json
name: "libnss-authentik"
arch: "${ARCH}"
platform: "linux"
version: "${VERSION}"
description: |
  NSS module for authentik
vendor: "Authentik Security Inc."
homepage: "https://goauthentik.io"
maintainer: "Authentik Security Inc."
license: "MIT"
section: security
contents:
  - src: ../cache/nss/release/libauthentik_nss.so
    dst: "/usr/lib/${DEB_BUILD_GNU_TYPE}/libnss_authentik.so.2"
    file_info:
      mode: 0644
    packager: deb
    expand: true
  - src: ../cache/nss/release/libauthentik_nss.so
    dst: "/usr/lib64/libnss_authentik.so.2"
    file_info:
      mode: 0644
    packager: rpm
overrides:
  deb:
    depends:
      - "authentik-sysd"
      - "libc6"
      - "libssl3 | libssl3t64"
    scripts:
      postinstall: ./_deb/postinst.sh
  rpm:
    depends:
      - "authentik-sysd"
      - "glibc"
      - "openssl-libs"
